<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Input • pagoo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Input">
<meta property="og:description" content="pagoo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-164668935-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-164668935-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pagoo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/pagoo.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Input.html">1 - Input</a>
    </li>
    <li>
      <a href="../articles/Querying_Data.html">2 - Querying Data</a>
    </li>
    <li>
      <a href="../articles/Subseting.html">3 - Subseting</a>
    </li>
    <li>
      <a href="../articles/Methods_Plots.html">4 - Methods and Plots</a>
    </li>
    <li>
      <a href="../articles/Recipes.html">5 - Recipes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iferres/pagoo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Input_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Input</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/iferres/pagoo/blob/master/vignettes/Input.Rmd" class="external-link"><code>vignettes/Input.Rmd</code></a></small>
      <div class="hidden name"><code>Input.Rmd</code></div>

    </div>

    
    
<div id="input-from-scratch" class="section level1">
<h1 class="hasAnchor">
<a href="#input-from-scratch" class="anchor" aria-hidden="true"></a>Input From Scratch</h1>
<p>In order to generate a <code>pagoo</code> object, the only mandatory data structure is a <code>data.frame</code> which has to contain 3 basic columns. Let’s illustrate it with an toy dataset.</p>
<p>First load <code>pagoo</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://iferres.github.io/pagoo/" class="external-link">pagoo</a></span><span class="op">)</span> <span class="co"># Load package</span>
<span class="va">tgz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'toy_data.tar.gz'</span>, package <span class="op">=</span> <span class="st">'pagoo'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/untar.html" class="external-link">untar</a></span><span class="op">(</span>tarfile <span class="op">=</span> <span class="va">tgz</span>, exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Decompress example dataset</span>
<span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">'tsv$|fasta$'</span><span class="op">)</span> <span class="co"># List files</span>
<span class="va">files</span></code></pre></div>
<pre><code>## [1] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/case_clusters_meta.tsv"
## [2] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/case_df.tsv"           
## [3] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/case_orgs_meta.tsv"    
## [4] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/organismA.fasta"       
## [5] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/organismB.fasta"       
## [6] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/organismC.fasta"       
## [7] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/organismD.fasta"       
## [8] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/organismE.fasta"</code></pre>
<p>The file we need now is <code>case_df.tsv</code>. Lets load it and see what’s its structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"case_df.tsv"</span>, <span class="va">files</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">data_file</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span>, quote <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code>##      gene       org cluster                             annot
## 1 gene081 organismA   OG001  Thioesterase superfamily protein
## 2 gene122 organismB   OG001          Thioesterase superfamily
## 3 gene299 organismC   OG001  Thioesterase superfamily protein
## 4 gene186 organismD   OG001  Thioesterase superfamily protein
## 5 gene076 organismE   OG001          Thioesterase superfamily
## 6 gene352 organismA   OG002 Inherit from proNOG: Thioesterase</code></pre>
<p>So it is a <code>data.frame</code> with 4 columns. The first one with the name of each gene, the second one with the organism to which each gene belongs, the third one with the cluster to which each gene was assigned in the pangenome reconstruction, and the last one with annotation metadata for each gene. Of the 4 columns, the former 3 are required, and <code>pagoo</code> will look for columns named “gene”, “org”, and “cluster”. More columns are optional, and you can add as many as you want (or none) to add metadata of each gene.</p>
<p>With only this data (even ignoring the fourth column, which is metadata), you can start working with pagoo:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pagoo.html">pagoo</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></code></pre></div>
<p>but let’s continue adding more.</p>
<div id="including-organism-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#including-organism-metadata" class="anchor" aria-hidden="true"></a>Including organism metadata</h2>
<p>The next 2 <code>.tsv</code> files contains metadata for each cluster and for each organism, respectively, and are optional arguments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Organism metadata</span>
<span class="va">orgs_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"case_orgs_meta.tsv"</span>, <span class="va">files</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">orgs_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">orgs_file</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span>, quote <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="va">orgs_meta</span><span class="op">)</span></code></pre></div>
<pre><code>##         org sero  country
## 1 organismA    a Westeros
## 2 organismB    b Westeros
## 3 organismC    c Westeros
## 4 organismD    a    Essos
## 5 organismE    b    Essos</code></pre>
<p>On this <code>data.frame</code> we have a column named <code>org</code> which is mandatory in case you provide this argument. Other columns are metadata associated to each organism. Beware that organisms provided in this table (<code>orgs_meta$org</code>) must coincide with the names provided in the <code>data$org</code> field, in order to correctly map each variables.</p>
</div>
<div id="including-cluster-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#including-cluster-metadata" class="anchor" aria-hidden="true"></a>Including cluster metadata</h2>
<p>Last file contains metadata associated with each cluster of orthologous:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Cluster metadata</span>
<span class="va">clust_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"case_clusters_meta.tsv"</span>, <span class="va">files</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">clust_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">clust_file</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span>, quote <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="va">clust_meta</span><span class="op">)</span></code></pre></div>
<pre><code>##   cluster   kegg  cog
## 1   OG001   &lt;NA&gt;    S
## 2   OG002   &lt;NA&gt;    S
## 3   OG003   &lt;NA&gt; &lt;NA&gt;
## 4   OG004   &lt;NA&gt;    D
## 5   OG005 K01990    V
## 6   OG006   &lt;NA&gt;    V</code></pre>
<p>Again, the column <code>clust_meta$cluster</code> must contain the same elements as <code>data$cluster</code> column to be able to map one into the other.</p>
<p>With all this data the <code>pagoo</code> object will look much more complete. But you can still add sequence information to the pangenome, which makes it much more useful and interesting to work with.</p>
</div>
<div id="including-sequences" class="section level2">
<h2 class="hasAnchor">
<a href="#including-sequences" class="anchor" aria-hidden="true"></a>Including sequences</h2>
<p>In this made up dataset we have 5 organisms, so if you decide to add sequences to the pangenome you must provide them for all 5 organisms. The type of data needed is a DNA multifasta file for each organism, in which each sequence is a gene whose name can be mapped to the <code>data$gene</code> column. You must first load the sequences into a <code>list</code>, and name each list element as the organism provided in <code>data$org</code> (as well as <code>org_meta$org</code>). The <code>list</code> would look something like:</p>
<ol style="list-style-type: decimal">
<li>organism1
<ul>
<li>gene1</li>
<li>gene2</li>
<li>…</li>
<li>geneN</li>
</ul>
</li>
<li>organism2
<ul>
<li>gene1</li>
<li>gene2</li>
<li>…</li>
<li>geneM</li>
</ul>
</li>
<li>organism3
<ul>
<li>gene1</li>
<li>gene2</li>
<li>…</li>
<li>geneP</li>
</ul>
</li>
<li>…</li>
</ol>
<p>In the case of the example we are working on:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sequences</span>
<span class="va">fasta_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"[.]fasta"</span>, <span class="va">files</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># List fasta files</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fasta_files</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'[.]fasta'</span>, <span class="st">''</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">fasta_files</span><span class="op">)</span><span class="op">)</span> <span class="co"># Name them </span>
<span class="co"># Read fasta files with Biostrings:</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings" class="external-link">Biostrings</a></span><span class="op">)</span>
<span class="va">sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fasta_files</span>, <span class="va">readDNAStringSet</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">sq</span><span class="op">)</span> <span class="co"># Is list?</span></code></pre></div>
<pre><code>## [1] "list"</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sq</span><span class="op">)</span> <span class="co"># One list element per organism</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sq</span><span class="op">)</span> <span class="co"># Names are the same as in data$org</span></code></pre></div>
<pre><code>## [1] "organismA" "organismB" "organismC" "organismD" "organismE"</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">sq</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># Class of each element of the list</span></code></pre></div>
<pre><code>## [1] "DNAStringSet"
## attr(,"package")
## [1] "Biostrings"</code></pre>
<p>And we have a <code>list</code> of <code>DNAStringSet</code> (Biostrings package). Now we can load a quite complete <code>pagoo</code> object (you could still add more metadata to genes, clusters, or organisms):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pagoo.html">pagoo</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="co"># Required data</span>
           org_meta <span class="op">=</span> <span class="va">orgs_meta</span>, <span class="co"># Organism's metadata</span>
           cluster_meta <span class="op">=</span> <span class="va">clust_meta</span>, <span class="co"># Cluster's metadata</span>
           sequences <span class="op">=</span> <span class="va">sq</span><span class="op">)</span> <span class="co"># Sequences</span></code></pre></div>
</div>
</div>
<div id="input-from-pangenome-reconstruction-software" class="section level1">
<h1 class="hasAnchor">
<a href="#input-from-pangenome-reconstruction-software" class="anchor" aria-hidden="true"></a>Input From Pangenome Reconstruction Software</h1>
<p>All the above stuff with preparing data and loading classes seems difficult and time-consuming, but in real life working datasets this will be rarely needed. We are explaining it here to provide full details about how the software works, but this package also provides functions to automatically read-in output files from pangenome reconstruction software into <code>pagoo</code>, avoiding any formatting or manipulation of data.</p>
<p>Currently <code>pagoo</code> supports input from <a href="https://sanger-pathogens.github.io/Roary/" class="external-link">roary</a> (Page et al., 2015), which has been the standard and most cited software for pangenome reconstruction, and <a href="https://github.com/gtonkinhill/panaroo" class="external-link">panaroo</a> (Tonkin-Hill et al., 2020). It is worth noticing that as roary become the most used software in this field, other tools as <a href="https://github.com/zheminzhou/PEPPAN" class="external-link">PEPPAN</a>, <a href="https://github.com/SionBayliss/PIRATE" class="external-link">PRIATE</a> and panaroo include scripts to convert their output to roary’s format. To work with <code>roary</code>’s output, please refer to <code><a href="../reference/roary_2_pagoo.html">?roary_2_pagoo</a></code> documentation. Although panaroo also includes a tool for this, we provide a function to load their native output format, see <code><a href="../reference/panaroo_2_pagoo.html">?panaroo_2_pagoo</a></code>. For both functions you will only need the <code>.gff</code> files used as input for roary of panaroo, and the <code>gene_presence_absence.csv</code> file.</p>
<p>Also, we have created our own pangenome reconstruction software called <a href="https://github.com/iferres/pewit" class="external-link">pewit</a> (Ferrés et al., still unpublished), which automatically generates a <code>pagoo</code>-like object to perform downstream analyses. This object contain all the methods and fields <code>pagoo</code> provides, plus a set of methods and fields exclusive to this software.</p>
<p>Other good pangenome reconstruction software already exists like <a href="https://pangenome.tuebingen.mpg.de" class="external-link">PanX</a> (Ding et al., 2018), <a href="https://github.com/cran/micropan" class="external-link">micropan</a> (Snipen &amp; Liland, 2015), <a href="https://github.com/eead-csic-compbio/get_homologues" class="external-link">GET_HOMOLOGUES</a> (Contreras-Moreira &amp; Vinuesa, 2013), among others. We plan to provide support to some of them in the future.</p>
</div>
<div id="adding-metadata-after-object-creation" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-metadata-after-object-creation" class="anchor" aria-hidden="true"></a>Adding Metadata After Object Creation</h1>
<p>After object creation, you may want to add new metadata given new information or as result of posterior analyses. <code>pagoo</code> objects include a function to add columns of metadata to each gene, each cluster, or each organism. To illustrate it, we will add a new column to the <code>$organisms</code> field named <code>host</code> to add made up information about the host where each genome was isolated from.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">host_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>org <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="va">organisms</span><span class="op">$</span><span class="va">org</span>, host <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cow"</span>, <span class="st">"Dog"</span>, <span class="st">"Cat"</span>, <span class="st">"Cow"</span>, <span class="st">"Sheep"</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">$</span><span class="fu">add_metadata</span><span class="op">(</span>map <span class="op">=</span> <span class="st">"org"</span>, <span class="va">host_df</span><span class="op">)</span>
<span class="va">p</span><span class="op">$</span><span class="va">organisms</span></code></pre></div>
<pre><code>## DataFrame with 5 rows and 4 columns
##         org        sero     country        host
##    &lt;factor&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;
## 1 organismA           a    Westeros         Cow
## 2 organismB           b    Westeros         Dog
## 3 organismC           c    Westeros         Cat
## 4 organismD           a       Essos         Cow
## 5 organismE           b       Essos       Sheep</code></pre>
<p>In order to allow <code>pagoo</code> correct data mapping, the values in the first column of the metadata table should be available at <code>p$organisms$org</code>, and its column header must also be named <code>org</code>.</p>
<p>As said, you can add <code>gene</code> or <code>cluster</code> metadata following the same idea.</p>
</div>
<div id="saving-and-loading-pagoo-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#saving-and-loading-pagoo-objects" class="anchor" aria-hidden="true"></a>Saving and Loading <code>pagoo</code> objects</h1>
<p>Once loaded, it has two methods for saving and reloading to a new R session. The first one is by saving them as flat (text) files:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pangenome"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>
<span class="va">p</span><span class="op">$</span><span class="fu">write_pangenome</span><span class="op">(</span>dir <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">tmp</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/pangenome/clusters.tsv" 
## [2] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/pangenome/data.tsv"     
## [3] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZAOgiL/pangenome/organisms.tsv"</code></pre>
<p>This creates a directory with 3 text files. The advantage of this approach is that you can analyze it outside R, the disadvantage is that from a reproducibility point of view reading text could be less stable since class or number precision can be lost, and also you can’t save the state of the object in any given time. Only available organisms/genes/clusters are saved, and if you reload the class using the tsv files, any previously dropped organisms/gene/cluster won’t be available any more. (For information about dropping/recovering organisms, see “Subset” tutorial).</p>
<p>If you want to save the object and continue working with it in other R session, we recommend to save them as R objects with the RDS methods provided:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pangenome.RDS"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>
<span class="va">p</span><span class="op">$</span><span class="fu">save_pangenomeRDS</span><span class="op">(</span>file <span class="op">=</span> <span class="va">rds</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_pangenomeRDS.html">load_pangenomeRDS</a></span><span class="op">(</span><span class="va">rds</span><span class="op">)</span></code></pre></div>
<p>This method is more stable (compatible between <code>pagoo</code> versions), secure (uses the same metadata classes, and precision isn’t lost), and convenient (the exact state of the object saved is restored, keeping dropped organisms/genes/clusters hidden, available to be recovered, and other object state configuration, e.g. <code>core_level</code>, is also saved).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ignacio Ferres, Gregorio Iraola, Institut Pasteur de Montevideo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
