<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a Pagoo Object — pagoo • pagoo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a Pagoo Object — pagoo" />
<meta property="og:description" content="This is the main function to load a pagoo object. It's safer and
more friendly than using pagoo's class constructors (PgR6,
PgR6M, and PgR6MS). This function returns either a
PgR6M class object, or a PgR6MS class object,
depending on the parameters provided. If sequences are provided, it returns
the latter. See below for more details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-164668935-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-164668935-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pagoo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.3.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/1-Quick_Start.html">1 - Quick Start</a>
    </li>
    <li>
      <a href="../articles/2-Input.html">2 - Input</a>
    </li>
    <li>
      <a href="../articles/3-Querying_Data.html">3 - Querying Data</a>
    </li>
    <li>
      <a href="../articles/4-Subseting.html">4 - Subseting</a>
    </li>
    <li>
      <a href="../articles/5-Methods_Plots.html">5 - Methods and Plots</a>
    </li>
    <li>
      <a href="../articles/6-Recipes.html">6 - Recipes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/iferres/pagoo/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a Pagoo Object</h1>
    <small class="dont-index">Source: <a href='https://github.com/iferres/pagoo/blob/master/R/read_functions.R'><code>R/read_functions.R</code></a></small>
    <div class="hidden name"><code>pagoo.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main function to load a pagoo object. It's safer and
more friendly than using pagoo's class constructors (<a href='PgR6.html'>PgR6</a>,
<a href='PgR6M.html'>PgR6M</a>, and <a href='PgR6MS.html'>PgR6MS</a>). This function returns either a
<code><a href='PgR6M.html'>PgR6M</a></code> class object, or a <code><a href='PgR6MS.html'>PgR6MS</a></code> class object,
depending on the parameters provided. If sequences are provided, it returns
the latter. See below for more details.</p>
    </div>

    <pre class="usage"><span class='fu'>pagoo</span>(
  <span class='no'>data</span>,
  <span class='no'>org_meta</span>,
  <span class='no'>cluster_meta</span>,
  <span class='no'>sequences</span>,
  <span class='kw'>core_level</span> <span class='kw'>=</span> <span class='fl'>95</span>,
  <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"__"</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A <code>data.frame</code> or
<code><a href='https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html'>DataFrame</a></code> containing at least the
following columns: <code>gene</code> (gene name), <code>org</code> (organism name to
which the gene belongs to), and <code>cluster</code> (group of orthologous to
which the gene belongs to). More columns can be added as metadata for each
gene.</p></td>
    </tr>
    <tr>
      <th>org_meta</th>
      <td><p>(optional) A <code>data.frame</code> or
<code><a href='https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html'>DataFrame</a></code> containging additional
metadata for organisms. This <code>data.frame</code> must have a column named
"org" with valid organisms names (that is, they should match with those
provided in <code>data</code>, column <code>org</code>), and additional columns will be
used as metadata. Each row should correspond to each organism.</p></td>
    </tr>
    <tr>
      <th>cluster_meta</th>
      <td><p>(optional) A <code>data.frame</code> or
<code><a href='https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html'>DataFrame</a></code> containging additional
metadata for clusters. This <code>data.frame</code> must have a column named
"cluster" with valid organisms names (that is, they should match with those
provided in <code>data</code>, column <code>cluster</code>), and additional columns
will be used as metadata. Each row should correspond to each cluster.</p></td>
    </tr>
    <tr>
      <th>sequences</th>
      <td><p>(optional) Can accept: 1) a named <code>list</code> of named
<code>character</code> vector. Name of list are names of organisms, names of
character vector are gene names; or 2) a named <code>list</code> of
<code><a href='https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html'>DNAStringSetList</a></code> objects (same
requirements as (1), but with BStringSet names as gene names); or 3) a
<code><a href='https://rdrr.io/pkg/Biostrings/man/XStringSetList-class.html'>DNAStringSetList</a></code> (same
requirements as (2) but <code>DNAStringSetList</code> names are organisms names).
If this parameter is used, then a <code><a href='PgR6MS.html'>PgR6MS</a></code> class object is
returned.</p></td>
    </tr>
    <tr>
      <th>core_level</th>
      <td><p>The initial core_level (thats the percentage of organisms a
core cluster must be in to be considered as part of the core genome). Must
be a number between 100 and 85, (default: 95). You can change it later by
using the <code>$core_level</code> field once the object was created.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>A separator. By default is '__'(two underscores). It will be used
to create a unique <code>gid</code> (gene identifier) for each gene. <code>gid</code>s
are created by pasting <code>org</code> to <code>gene</code>, separated by <code>sep</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code>. Whether to display progress messages when
loading class.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This package uses
[R6](https://r6.r-lib.org/articles/Introduction.html) classes to provide a
unified, comprehensive, standarized, but at the same time flexible, way to
analyze a pangenome. The idea is to have a single object which contains both
the data and the basic methods to analyze them, as well as manipulate fields,
explore, and to use in harmony with the already existing and extensive list of R
packages available created for comparative genomics and genetics.</p>
<p>For more information, tutorials, and resources, please visit XXXXXXXXXXXXXXXX.</p>
<p>Above you will find a detailed description of each method/field provided
once you load a pagoo object.</p>
    <h2 class="hasAnchor" id="index"><a class="anchor" href="#index"></a>Index</h2>

    

<h3>Active Bindings</h3>
<p></p><ul>
<li><p><a href='#field-pan_matrix'><code>$pan_matrix</code></a></p></li>
<li><p><a href='#field-organisms'><code>$organisms</code></a></p></li>
<li><p><a href='#field-clusters'><code>$clusters</code></a></p></li>
<li><p><a href='#field-genes'><code>$genes</code></a></p></li>
<li><p><a href='#field-sequences'><code>$sequences</code></a></p></li>
<li><p><a href='#field-core_level'><code>$core_level</code></a></p></li>
<li><p><a href='#field-core_genes'><code>$core_genes</code></a></p></li>
<li><p><a href='#field-core_clusters'><code>$core_clusters</code></a></p></li>
<li><p><a href='#field-core_sequences'><code>$core_sequences</code></a></p></li>
<li><p><a href='#field-shell_genes'><code>$shell_genes</code></a></p></li>
<li><p><a href='#field-shell_clusters'><code>$shell_clusters</code></a></p></li>
<li><p><a href='#field-shell_sequences'><code>$shell_sequences</code></a></p></li>
<li><p><a href='#field-cloud_genes'><code>$cloud_genes</code></a></p></li>
<li><p><a href='#field-cloud_clusters'><code>$cloud_clusters</code></a></p></li>
<li><p><a href='#field-cloud_sequences'><code>$cloud_sequences</code></a></p></li>
</ul>


    <h2 class="hasAnchor" id="active-bindings"><a class="anchor" href="#active-bindings"></a>Active bindings</h2>

    

<dl>


</dl>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    

<dl>
    Below is a comprehensive description of all the methods provided by the object.

    html<a id="method-add_metadata"></a>
    <dt><b>Add metadata</b></dt><dd><p><h3>Description:</h3>
<p>Add metadata to the object. You can add metadata to each organism, to each
                  group of orthologous, or to each gene. Elements with missing data should be filled
                  by <code>NA</code> (dimensions of the provided data.frame must be coherent with object
                  data).</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$add_metadata(map = 'org', df)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>map</code></b>: <code>character</code> identifiying the metadata to map. Can
                    be one of <code>"org"</code>, <code>"group"</code>, or <code>"gid"</code>.</p></li>
<li><p><b><code>df</code></b>: <code>data.frame</code> or <code>DataFrame</code> with the metadata to
                    add. For ethier case, a column named as <code>"map"</code> must exists, which should
                    contain identifiers for each element. In the case of adding gene (<code>gid</code>)
                    metadata,each gene should be referenced by the name of the organism and the name
                    of the gene as provided in the <code>"data"</code> data.frame, separated by the
                    <code>"sep"</code> argument.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p><code>self</code> invisibly, but with additional metadata.</p></p></dd>

    html<a id="method-drop"></a>
    <dt><b>Drop an organism</b></dt><dd><p><h3>Description:</h3>
<p>Drop an organism from the dataset. This method allows to hide an organism from
                   the real dataset, ignoring it in downstream analyses. All the fields and
                   methods will behave as it doesn't exist. For instance, if you decide to drop
                   organism 1, the <code>$pan_matrix</code> field (see below) would not show it when
                   called.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$drop(x)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>x</code></b>:  <code>character</code> or <code>numeric</code>. The name of the
                    organism wanted to be dropped, or its numeric id as returned in
                    <code>$organism</code> field (see below).</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p><code>self</code> invisibly, but with <code>x</code> dropped. It isn't necessary
                    to assign the function call to a new object, nor to re-write it as R6 objects
                    are mutable.</p></p></dd>

    html<a id="method-recover"></a>
    <dt><b>Recover a dropped organism</b></dt><dd><p><h3>Description:</h3>
<p>Recover a previously <code>$drop()</code>ped organism (see above). All fields
                  and methods will start to behave considering this organism again.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$recover(x)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>x</code></b>: <code>character</code> or <code>numeric</code>. The name of the
                    organism wanted to be recover, or its numeric id as returned in
                    <code>$dropped</code> field (see below).</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p><code>self</code> invisibly, but with <code>x</code> recovered. It isn't necessary
                    to assign the function call to a new object, nor to re-write it as R6 objects
                    are mutable.</p></p></dd>

    html<a id="method-write_pangenome"></a>
    <dt><b>Write a pangenome as flat (text) files.</b></dt><dd><p><h3>Description:</h3>
<p>Write the pangenome data as flat tables (text). Is not the most recomended way
                  to save a pangenome, since you can loose information as numeric precision,
                  column classes (factor, numeric, integer), and the state of the object itself
                  (i.e. dropped organisms, or core_level), loosing reproducibility. Use
                  <code>save_pangenomeRDS</code> for a more precise way of saveing a pagoo object.
                  Still, it is useful if you want to work with the data outside R, just keep
                  the above in mind.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$write_pangenome(dir = "pangenome", force = FALSE)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>dir</code></b>: The unexisting directory name where to put the data files. Default
                    is "pangenome".</p></li>
<li><p><b><code>force</code></b>: <code>logical</code>. Whether to overwrite the directory if it already
                    exists. Default: <code>FALSE</code>.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A directory with at least 3 files. "data.tsv" contain the basic
                    pangenome data as it is provided to the <code>data</code> argumnet in the
                    initialization method (<code>$new(...)</code>). "clusters.tsv" contain any metadata
                    asociated to the clusters. "organisms.tsv" contain any metadata asociated to
                    the organisms. The latter 2 files will contain a single column if no metadata
                    was provided.</p></p></dd>

    html<a id="method-save_pangenomeRDS"></a>
    <dt><b>Save a pangenome as a RDS (binary) file.</b></dt><dd><p><h3>Description:</h3>
<p>Save a pagoo pangenome object. This function provides a method for saving a pagoo
                 object and its state into a "RDS" file. To load the pangenome, use the
                 <code>load_pangenomeRDS</code> function in this package. It *should* be compatible between
                 pagoo versions, so you could update pagoo and still recover the same pangenome. Even
                 <code>sep</code> and <code>core_level</code> are restored unless the user provides those
                 arguments in <code>load_pangenomeRDS</code>. <code>dropped</code> organisms also kept hidden, as
                 you where working with the original object.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$save_pangenomeRDS(file = "pangenome.rds")</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>file</code></b>: The name of the file to save. Default: "pangenome.rds".</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>Writes a list with all the information needed to restore the object by
                    using the load_pangenomeRDS function, into an RDS (binary) file.</p></p></dd>

    html<a id="method-clone"></a>
    <dt><b>Clone a pagoo object.</b></dt><dd><p><h3>Description:</h3>
<p>The objects of this class are cloneable with this method.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$clone(deep = FALSE)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>deep</code></b>: <code>character</code> identifiying the metadata to map. Can
                    be one of <code>"org"</code>, <code>"group"</code>, or <code>"gid"</code>.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>Whether to make a deep clone.</p></p></dd>

    html<a id="method-dist"></a>
    <dt><b>Compute distances</b></dt><dd><p><h3>Description:</h3>
<p>Compute distance between all pairs of genomes. The default dist method is
                  <code>"bray"</code> (Bray-Curtis distance). Annother used distance method is <code>"jaccard"</code>,
                  but you should set <code>binary = FALSE</code> (see below) to obtain a meaningful result.
                  See <code><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></code> for details, this is just a wrapper function.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$dist(
                  method = "bray",
                  binary = FALSE,
                  diag = FALSE,
                  upper = FALSE,
                  na.rm = FALSE,
                  ...
                  )</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>method</code></b>: The distance method to use. See <a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a>
                    for available methods, and details for each one.</p></li>
<li><p><b><code>binary</code></b>: Transform abundance matrix into a presence/absence
                    matrix before computing distance.</p></li>
<li><p><b><code>diag</code></b>: Compute diagonals.</p></li>
<li><p><b><code>upper</code></b>: Return only the upper diagonal.</p></li>
<li><p><b><code>na.rm</code></b>: Pairwise deletion of missing observations when
                    computing dissimilarities.</p></li>
<li><p><b><code>...</code></b>: Other parameters. See <a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a> for details.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A <code>dist</code> object containing all pairwise dissimilarities between genomes.</p></p></dd>

    html<a id="method-pan_pca"></a>
    <dt><b>Compute a Principal Component Analysis</b></dt><dd><p><h3>Description:</h3>
<p>Performs a principal components analysis on the panmatrix.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$pan_pca( center = TRUE, scale. = FALSE, ...)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>center</code></b>: a logical value indicating whether the variables should be shifted
                    to be zero centered. Alternately, a vector of length equal the number of columns of x can be
                    supplied. The value is passed to scale.</p></li>
<li><p><b><code>scale.</code></b>: a logical value indicating whether the variables should be scaled
                    to have unit variance before the analysis takes place. The default is TRUE.</p></li>
<li><p><b><code>...</code></b>: Other arguments. See <a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>Returns a list with class "prcomp". See <a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a> for more information.</p></p></dd>

    html<a id="method-pg_power_law_fit"></a>
    <dt><b>Fit a Power Law Function for the Pangenome</b></dt><dd><p><h3>Description:</h3>
<p>Fits a power law curve for the pangenome rarefaction simulation.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$pg_power_law_fit(raref, ...)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>raref</code></b>: (Optional) A rarefaction matrix, as returned by <code>rarefact()</code>.</p></li>
<li><p><b><code>...</code></b>: Further arguments to be passed to <code>rarefact()</code>. If <code>raref</code>
                    is missing, it will be computed with default arguments, or with the ones provided here.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A <code>list</code> of two elements: <code>$formula</code> with a fitted function, and <code>$params</code>
                    with fitted parameters. An attribute <code>"alpha"</code> is also returned (If
                    <code>alpha&gt;1</code>, then the pangenome is closed, otherwise is open.</p></p></dd>

    html<a id="method-cg_exp_decay_fit"></a>
    <dt><b>Fit an Exponential Decay Function for the Coregenome</b></dt><dd><p><h3>Description:</h3>
<p>Fits an exponential decay curve for the coregenome rarefaction simulation.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$cg_exp_decay_fit(raref, pcounts = 10, ...)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>raref</code></b>: (Optional) A rarefaction matrix, as returned by <code>rarefact()</code>.</p></li>
<li><p><b><code>pcounts</code></b>: An integer of pseudo-counts. This is used to better fit the function
                    at small numbers, as the linearization method requires to substract a constant C, which is the
                    coregenome size, from <code>y</code>. As <code>y</code> becomes closer to the coregenome size, this operation
                    tends to 0, and its logarithm goes crazy. By default <code>pcounts=10</code>.</p></li>
<li><p><b><code>...</code></b>: Further arguments to be passed to <code>rarefact()</code>. If <code>raref</code>
                    is missing, it will be computed with default arguments, or with the ones provided here.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A <code>list</code> of two elements: <code>$formula</code> with a fitted function, and <code>$params</code>
                    with fitted intercept and decay parameters.</p></p></dd>

    html<a id="method-fluidity"></a>
    <dt><b>Compute Genomic Fluidity</b></dt><dd><p><h3>Description:</h3>
<p>Computes the genomic fluidity, which is a measure of population
                  diversity. See <code><a href='https://rdrr.io/pkg/micropan/man/fluidity.html'>fluidity</a></code> for more details.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$fluidity(nsim = 10)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>nsim</code></b>:An integer specifying the number of random samples
                     to use in the computations.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A list with two elements, the mean fluidity and its sample standard
                    deviation over the n.sim computed values.</p></p></dd>

    html<a id="method-gg_barplot"></a>
    <dt><b>Plot Accessory Frequency Plot</b></dt><dd><p><h3>Description:</h3>
<p>Plot a barplot with the frequency of genes within the total number of
                  genomes.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$gg_barplot()</code></p>            <h3>Return:</h3>
<p>A barplot, and a <code>gg</code> object (<code>ggplot2</code> package) invisibly.</p></p></dd>

    html<a id="method-gg_dist"></a>
    <dt><b>Plot a Distance Heatmap</b></dt><dd><p><h3>Description:</h3>
<p>Plot a heatmap showing the computed distance between all pairs of organisms.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$gg_dist(method = "bray", ...)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>method</code></b>: Distance method. One of "Jaccard" (default), or
                    "Manhattan",see above.</p></li>
<li><p><b><code>...</code></b>: More arguments to be passed to <code><a href='https://rdrr.io/pkg/micropan/man/distManhattan.html'>distManhattan</a></code></p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A heatmap (<code><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>ggplot2::geom_tile()</a></code>), and a <code>gg</code> object (<code>ggplot2</code>
                     package) invisibly.</p></p></dd>

    html<a id="method-gg_binmap"></a>
    <dt><b>Plot a Pangenome Binary Map</b></dt><dd><p><h3>Description:</h3>
<p>Plot a pangenome binary map representing the presence/absence of each
                  gene within each organism.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$gg_binmap()</code></p>            <h3>Return:</h3>
<p>A binary map (<code><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>ggplot2::geom_raster()</a></code>), and a <code>gg</code> object (<code>ggplot2</code>
                    package) invisibly.</p></p></dd>

    html<a id="method-gg_pca"></a>
    <dt><b>Plot a PCA</b></dt><dd><p><h3>Description:</h3>
<p>Plot a scatter plot of a Principal Components Analysis.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$gg_pca(colour = NULL, ...))</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>colour</code></b>:The name of the column in <code>$organisms</code> field
                    from which points will takecolour (if provided). <code>NULL</code> (default) renders
                    black points.</p></li>
<li><p><b><code>...</code></b>: More arguments to be passed to <code><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>ggplot2::autoplot()</a></code>.</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A scatter plot (<code><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>ggplot2::autoplot()</a></code>), and a <code>gg</code> object
                    (<code>ggplot2</code> package) invisibly.</p></p></dd>

    html<a id="method-gg_pie"></a>
    <dt><b>Plot a Pie with Pangenome Categories</b></dt><dd><p><h3>Description:</h3>
<p>Plot a pie chart showing the number of clusters of each pangenome category: core,
                  shell, or cloud.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$gg_pie()</code></p>            <h3>Return:</h3>
<p>A pie chart (<code>ggplot2::geom_bar() + coord_polar()</code>), and a
                    <code>gg</code> object (<code>ggplot2</code> package) invisibly.</p></p></dd>

    html<a id="method-gg_curves"></a>
    <dt><b>Plot Pangenome Curves</b></dt><dd><p><h3>Description:</h3>
<p>Plot pangenome and/or coregenome curves with the fitted functions returned by
                  <code>pg_power_law_fit()</code> and <code>cg_exp_decay_fit()</code>. You can add points by
                  adding <code>+ geom_points()</code>, of ggplot2 package.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$gg_curves(what = c("pangenome", "coregenome", ...)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>what</code></b>:  <code>"pangenome"</code> and/or <code>"coregenome"</code>.</p></li>
<li><p><b><code>...</code></b>: ignored</p></li>
</ul><p></p>
            <h3>Return:</h3>
<p>A scatter plot, and a <code>gg</code> object (<code>ggplot2</code> package) invisibly.</p></p></dd>

    html<a id="method-runShinyApp"></a>
    <dt><b>Run a Shiny App</b></dt><dd><p><h3>Description:</h3>
<p>Launch an interactive shiny app. It contains a sidebar
                  with controls and switches to interact with the pagoo
                  object. You can drop/recover organisms from the dataset,
                  modify the core_level, visualize statistics, plots, and
                  browse cluster and gene information. In the main body, it
                  contains 2 tabs to switch between summary statistics plots
                  and core genome information on one side, and accessory
                  genome plots and information on the other.</p>
<p>The lower part of each tab contains two tables, side by
                  side. On the "Summary" tab, the left one contain
                  information about core clusters, with one cluster per row.
                  When one of them is selected (click), the one on the right
                  is updated to show information about its genes (if
                  provided), one gene per row. On the "Accessory" tab, a
                  similar configuration is shown, but on this case only
                  accessory clusters/genes are displayed. There is a slider
                  on the sidebar where one can select the accessory
                  frequency range to display.</p>
<p>Give it a try!</p>
<p>Take into account that big pangenomes can slow down the
                  performance of the app. More than 50-70 organisms often
                  leads to a delay in the update of the plots/tables.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$runShinyApp()</code></p>            <h3>Return:</h3>
<p>Opens a shiny app on the browser.</p></p></dd>

    html<a id="method-core_seqs_4_phylo"></a>
    <dt><b>Retrieve Core Genes for Phylogeny</b></dt><dd><p><h3>Description:</h3>
<p>A field for obtaining core gene sequences is available (see below),
                 but for creating a phylogeny with this sets is useful to: 1) have the
                 possibility of extracting just one sequence of each organism on each
                 cluster, in case paralogues are present, and 2) filling gaps with
                 empthy sequences in case the core_level was set below 100%, allowing
                 more genes (some not in 100% of organisms) to be incorporated to the
                 phylogeny. That is the purpose of this special function.</p>            <h3>Usage:</h3>
<p><code>                  </code><code>$core_seqs_4_phylo(max_per_org = 1, fill = TRUE)</code></p>            <h3>Arguments:</h3>
<p></p><ul>
<li><p><b><code>max_per_org</code></b>:  Maximum number of sequences of each organism
                    to be taken from each cluster.</p></li>
<li><p><b><code>fill</code></b>: <code>logical</code>. If fill <code>DNAStringSet</code> with
                    emphty <code>DNAString</code> in cases where <code>core_level</code> is set below 100%,
                    and some clusters with missing organisms are also considered.</p></li>
</ul><p></p>            <h3>Return:</h3>
<p>A <code>DNAStringSetList</code> with core genes. Order of organisms on each cluster
                   is conserved, so it is easier to concatenate them into a super-gene suitable
                   for phylogenetic inference.</p></p></dd>

</dl>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ignacio Ferres, Gregorio Iraola, Institut Pasteur de Montevideo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


